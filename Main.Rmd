---
title: "Data Exploration Assignment Due - 4th week of October"
author: "Shreya and Francis"
date: "October 14, 2017"
output: html_document
---

## Action Needed by Francis (opened by Shreya)

Also, one thing to may be consider in there is to check that we change before the particular date when this gre score system was used, irrespective of the system, we need to consider that well. - Thoughts on this Francis?

Could you please update when you have the regression thing you are working on and the data exploration part as well!



## Action Needed by Shreya (Please add any concerns or questions for Shreya here)









## Read_Files

```{r}
install.packages("readxl")
```

```{r}
library(readxl)
appbase <- read_excel("C:/Users/Shreya/Documents/GITHUB/Capstone/ApplicationBase.xlsx")
```

```{r}
library(readxl)
appdecision <- read_excel("C:/Users/Shreya/Documents/GITHUB/Capstone/ApplicationDecisions.xlsx")
```

```{r}
library(readxl)
eventattendance <- read_excel("C:/Users/Shreya/Documents/GITHUB/Capstone/PersonEventAttendance.xlsx")
```

```{r}
library(readxl)
gre <- read_excel("C:/Users/Shreya/Documents/GITHUB/Capstone/PersonGRE.xlsx")
```

```{r}
library(readxl)
login <- read_excel("C:/Users/Shreya/Documents/GITHUB/Capstone/PersonLogins.xlsx")
```

```{r}
library(readxl)
message <- read_excel("C:/Users/Shreya/Documents/GITHUB/Capstone/PersonMessages.xlsx")
```

```{r}
library(readxl)
school <- read_excel("C:/Users/Shreya/Documents/GITHUB/Capstone/PersonSchools.xlsx")
```




## Gre
GRE: Gre Scores of students with 3 main categories in these scores: Verbal (Range 0-170), Quantitative (Range 0-170) and Writing (Range 0-6)

Remove Student with identity code 
"90584" 
Reason: 0 GRE score information on quantitative aptitude


Remove the identity variable and get a new dataset named gre1 to see for trends in the scores for the admitted students
```{r}
gre1 <- gre[-c(1)]
```

```{r}
plot(gre1)
```

After viewing these plots it is well clear that #the #Institue offers admissions to a diverse population and does not count GRE score to be one of the compulsary requirements in the process of admissions.

```{r}
install.packages("psych")
```

```{r}
library(psych)
pairs.panels(gre1[c(1:3)], gap = 0)
```

The pair panels clearly state that th writing scores are not corelated at all with the quantitative scores for the given students at a positive 0.01 corelation (0 being the least and 1 or -1 being perfect corelation)

Also, what is interesting to note is that verbal scores and writing dont show a significant coreltion in the pair plots (+0.06 only)

But, Verbal scores a positively corelated with quantitative scores with corelation of 0.96 


```{r}
hist(gre$Verbal)
```

This simple histogram of verbal score shows that there are 2 scales of gre cale that are currently being used in the data

one is current scale of 0-170 (increments of 1 point) (maximum student population has this score range)
other is prior / traditional scale of 0 - 800 (increments of 10 points) (changed on August 2011)

```{r}
hist(gre$Quantitative)
```

```{r}
hist(gre$Writing)
```

Maximum admitted students have 3 or more score level on a scale of 0-6.

Suggested by Charles - I went wrong on the decision of deleting the student data at all initially (Shreya), but he suggests that we find an algorithm or may be create on to convert scores from one form to another to not lose data and utilize all data points it well

GRE_score conversion from traditional to new scale (Shreya made the code - can't locate anything on the web and so this)
```{r}
gre$Quantitative_new <- 
  ifelse(gre$Quantitative >=760, 170,
         ifelse(gre$Quantitative ==750, 169,
                ifelse(gre$Quantitative ==740, 169,
                       ifelse(gre$Quantitative == 730, 168,
                              ifelse(gre$Quantitative == 720, 168,
                                     ifelse(gre$Quantitative == 710, 167,
                                            ifelse(gre$Quantitative == 700, 166,
                                                   ifelse(gre$Quantitative == 690, 165,
                                                          ifelse(gre$Quantitative == 680, 165, 
                                                                ifelse(gre$Quantitative ==670, 164,
         ifelse(gre$Quantitative ==660, 164,
                ifelse(gre$Quantitative ==650, 163,
                       ifelse(gre$Quantitative == 640, 162,
                              ifelse(gre$Quantitative == 630, 162,
                                     ifelse(gre$Quantitative == 620, 161,
                                            ifelse(gre$Quantitative == 610, 160,
                                                   ifelse(gre$Quantitative == 600, 160,
                                                          ifelse(gre$Quantitative == 590, 159, 
                                                                 ifelse(gre$Quantitative ==580, 158,
         ifelse(gre$Quantitative ==570, 158,
                ifelse(gre$Quantitative ==560, 157,
                       ifelse(gre$Quantitative == 550, 156,
                              ifelse(gre$Quantitative == 540, 156,
                                     ifelse(gre$Quantitative == 530, 155,
                                            ifelse(gre$Quantitative == 520, 154,
                                                   ifelse(gre$Quantitative == 510, 154,
                                                          ifelse(gre$Quantitative == 500, 153,
                                                                 ifelse(gre$Quantitative ==490, 152,
         ifelse(gre$Quantitative ==480, 152,
                ifelse(gre$Quantitative ==470, 151,
                       ifelse(gre$Quantitative == 460, 151,
                              ifelse(gre$Quantitative == 450, 150,
                                     ifelse(gre$Quantitative == 440, 149,
                                            ifelse(gre$Quantitative == 430, 149,
                                                   ifelse(gre$Quantitative == 420, 148,
                                                          ifelse(gre$Quantitative == 410, 147,
                                                                 ifelse(gre$Quantitative ==400, 146,
         ifelse(gre$Quantitative ==390, 146,
                ifelse(gre$Quantitative ==380, 145,
                       ifelse(gre$Quantitative == 370, 144,
                              ifelse(gre$Quantitative == 360, 143,
                                     ifelse(gre$Quantitative == 350, 143,
                                            ifelse(gre$Quantitative == 340, 142,
                                                   ifelse(gre$Quantitative == 330, 141,
                                                          ifelse(gre$Quantitative == 320, 140, 
         ifelse(gre$Quantitative ==310, 139,
                ifelse(gre$Quantitative ==300, 138,
                       ifelse(gre$Quantitative == 290, 137,
                              ifelse(gre$Quantitative == 280, 135,
                                     ifelse(gre$Quantitative ==759, 170, 
                                            gre$Quantitative))))))))))))))))))))))))))))))))))))))))))))))))))
```

```{r}
gre$Verbal_new <- 
  ifelse(gre$Verbal >=760, 170,
         ifelse(gre$Verbal ==750, 169,
                ifelse(gre$Verbal ==740, 169,
                       ifelse(gre$Verbal == 730, 168,
                              ifelse(gre$Verbal == 720, 168,
                                     ifelse(gre$Verbal == 710, 167,
                                            ifelse(gre$Verbal == 700, 166,
                                                   ifelse(gre$Verbal == 690, 165,
                                                          ifelse(gre$Verbal == 680, 165, 
                                                                ifelse(gre$Verbal ==670, 164,
         ifelse(gre$Verbal ==660, 164,
                ifelse(gre$Verbal ==650, 163,
                       ifelse(gre$Verbal == 640, 162,
                              ifelse(gre$Verbal == 630, 162,
                                     ifelse(gre$Verbal == 620, 161,
                                            ifelse(gre$Verbal == 610, 160,
                                                   ifelse(gre$Verbal == 600, 160,
                                                          ifelse(gre$Verbal == 590, 159, 
                                                                 ifelse(gre$Verbal ==580, 158,
         ifelse(gre$Verbal ==570, 158,
                ifelse(gre$Verbal ==560, 157,
                       ifelse(gre$Verbal == 550, 156,
                              ifelse(gre$Verbal == 540, 156,
                                     ifelse(gre$Verbal == 530, 155,
                                            ifelse(gre$Verbal == 520, 154,
                                                   ifelse(gre$Verbal == 510, 154,
                                                          ifelse(gre$Verbal == 500, 153,
                                                                 ifelse(gre$Verbal ==490, 152,
         ifelse(gre$Verbal ==480, 152,
                ifelse(gre$Verbal ==470, 151,
                       ifelse(gre$Verbal == 460, 151,
                              ifelse(gre$Verbal == 450, 150,
                                     ifelse(gre$Verbal == 440, 149,
                                            ifelse(gre$Verbal == 430, 149,
                                                   ifelse(gre$Verbal == 420, 148,
                                                          ifelse(gre$Verbal == 410, 147,
                                                                 ifelse(gre$Verbal ==400, 146,
         ifelse(gre$Verbal ==390, 146,
                ifelse(gre$Verbal ==380, 145,
                       ifelse(gre$Verbal == 370, 144,
                              ifelse(gre$Verbal == 360, 143,
                                     ifelse(gre$Verbal == 350, 143,
                                            ifelse(gre$Verbal == 340, 142,
                                                   ifelse(gre$Verbal == 330, 141,
                                                          ifelse(gre$Verbal == 320, 140, 
         ifelse(gre$Verbal ==310, 139,
                ifelse(gre$Verbal ==300, 138,
                       ifelse(gre$Verbal == 290, 137,
                              ifelse(gre$Verbal == 280, 135,
                                     ifelse(gre$Verbal ==759, 170, 
                                            gre$Verbal))))))))))))))))))))))))))))))))))))))))))))))))))
```

We are assuming that no students obtained scores on the scale of 0 to 270 on the traditional score scale since that is a very low score to obtain. In case there are such cases in the future (which should not be the case, since this scale has been discontinued), we may want to consider updating the above code to convert. 



```{r}
hist(gre$Verbal_new)
```

```{r}
hist(gre$Quantitative_new)
```

```{r}
hist(gre$Writing)
```


## Event_Attendance
```{r}
summary(eventattendance)
```

```{r}
counts <- table(eventattendance$EventType)
par(las=2)
par(mar=c(5,15,4,2)) 
barplot(counts, main="Event Attendance Barplot", horiz=TRUE, xlab="Number of Attendees", col="chartreuse3")
```

6 diffent event types, plot shows the frequency people attend the most.
will explore more

interesting if we had some data from those who enroll to comare

This plot shows that out of the possible 4765 students we have in the master data set, only 562 paid event attendance were recorded from these students which included only 510 unique students to attend the events.

We can hypothise, that students who do not attend any events may have a higher chance of not enrolling in the program even if they are offered admission.

Add to appbase and check if they attended before or after submitting or offereing admission.


## Application_Decision
```{r}
counts <- table(appdecision$decision_name)

par(las=2)
par(mar=c(5,16,4,2)) 
barplot(counts, main="Decision Name Barplot", horiz=TRUE, xlab="Number of Students in each decision type", col="chartreuse3")
```

```{r}
A <- unique(appdecision$identity)
B <- unique(appbase$identity)
```

This tells us that there are only 4470 unique students, but there are repeats in appbase, what does that mean? why arnt they clubbed in the appbase data together






## Starting with Merging data
```{r}
mydata <- merge(appbase, gre, by="identity", all=TRUE)
```





## Phase I - Barplots and Histograms

###1
```{r}
school$gpa_numeric <- ifelse(school$gpa == "NULL", NA, school$gpa)
school$gpa_numeric <- as.numeric(school$gpa_numeric)
range(school$gpa_numeric, na.rm = TRUE)
```

```{r}
school$gpa_numeric <- ifelse(school$gpa == "65", NA, school$gpa)
school$gpa_numeric <- as.numeric(school$gpa_numeric)
```

```{r}
library(ggplot2)
school$gpa_numeric <- as.numeric(school$gpa_numeric)
ggplot(data=school, aes(school$gpa_numeric)) + 
  geom_histogram(breaks=seq(0, 4.4, by = 0.2), 
                 col="red", 
                 aes(fill=..count..)) +
  scale_fill_gradient("Count", low = "green", high = "red") +
  labs(title="Previous School GPA Records")
```

###2
```{r}
school$earned_degree_num <- ifelse(school$earned_degree == "N", "No", ifelse(school$earned_degree == "Y", "Yes", school$earned_degree))
```

```{r}
counts <- table(school$earned_degree_num)
barplot(counts, col=c("chartreuse3"), main="Priviously: Degree Earned or Not (dropped)", xlab="Yes/No",  ylab="Number of Cases reported in total")
```

###3,4,5,6
```{r}
library(ggplot2)
gre$Verbal_new <- as.numeric(gre$Verbal_new)
ggplot(data=gre, aes(gre$Verbal_new)) + 
  geom_histogram(breaks=seq(0, 170, by = 2), 
                 col="chartreuse4", 
                 aes(fill=..count..)) +
  scale_fill_gradient("Count", low = "yellow", high = "chartreuse4")+
  labs(title="Histogram for Verbal Scores recorded in the GRE", x="Verbal Score (Max = 170)", y="Number of recorded student cases")
```

```{r}
library(ggplot2)
gre$Quantitative_new <- as.numeric(gre$Quantitative_new)
ggplot(data=gre, aes(gre$Quantitative_new)) + 
  geom_histogram(breaks=seq(0, 170, by = 2), 
                 col="blue", 
                 aes(fill=..count..)) +
  scale_fill_gradient("Count", low = "green", high = "blue")+
  labs(title="Histogram for Quantitative Scores recorded in the GRE", x="Quantitative Score (Max = 170)", y="Number of recorded student cases")
```

```{r}
library(ggplot2)
gre$Writing <- as.numeric(gre$Writing)
ggplot(data=gre, aes(gre$Writing)) + 
  geom_histogram(breaks=seq(0, 6, by = 0.5), 
                 col="purple4", 
                 aes(fill=..count..)) +
  scale_fill_gradient("Count", low = "orchid", high = "purple4")+
  labs(title="Histogram for Writing Scores recorded in the GRE", x="Quantitative Score (Scale 0-6)", y="Number of recorded student cases")
```

```{r}
gre$total <- gre$Verbal_new+gre$Quantitative_new
```

```{r}
library(ggplot2)
gre$total <- as.numeric(gre$total)
ggplot(data=gre, aes(gre$total)) + 
  geom_histogram(breaks=seq(140, 340, by = 5), 
                 col="mediumblue", 
                 aes(fill=..count..)) +
  scale_fill_gradient("Count", low = "darkorange", high = "mediumblue")+
  labs(title="Histogram for Verbal and Quants Scores recorded in the GRE", x="Quantitative (Max = 340)", y="Number of recorded student cases")
```

###7
```{r}
counts <- table(eventattendance$EventType)
par(las=2)
par(mar=c(5,15,4,2)) 
barplot(counts, main="Event Attendance Barplot", horiz=TRUE, xlab="Number of Attendees", col="chartreuse3")
```

###8
```{r}
counts <- table(appdecision$decision_name)
par(las=2)
par(mar=c(5,16,4,2)) 
barplot(counts, main="Decision Name Barplot", horiz=TRUE, xlab="Number of Students in each decision type", col="chartreuse3")
```

###9 - Needs Changes 
```{r}
counts <- table(appbase$`Credits Req`)
barplot(counts, main="Number of Credits applied for or required", xlab="Number of Credits", col="blueviolet", ylab="Number of Applicants")
```

###10
```{r}
count1 <- table(appbase$app_number)
barplot(count1, main="Number of App_Number", xlab="Number of Apps", col=c("chocolate4","chocolate", "chocolate2", "chocolate1", "chocolate1"), ylab="Number of Applicants")
```


###11
```{r}
appbase$sex_1 <- ifelse(appbase$sex == "NULL", "Not_Stated", appbase$sex)
```

```{r}
count2 <- table(appbase$sex_1)
barplot(count2, main="Gender Dominance amongst Applicants", xlab="Gender", col=c(115), ylab="Number of Applicants")
```

###12
```{r}
appbase$PrevApply_1 <- ifelse(appbase$PrevApply == "0", "No", "Yes")
```

```{r}
count4 <- table(appbase$PrevApply_1)
barplot(count4, main="Previous_Applicant or not", xlab="Previous Applicant or Not", col="violetred", ylab="Number of Applicants")
```

###13
```{r}
count5 <- table(appbase$EverDeposited)
barplot(count5, main="Applicant_Deposited_Entry_Fee_or_Not", xlab="Applicant_Deposited_Entry_Fee_or_Not", ylab="Number_of_Applicants",col="olivedrab")
```

###14
```{r}
appbase$Scholarship_app_1 <- ifelse(appbase$Scholarship_app == "0", "No", "Yes")
```

```{r}
count6 <- table(appbase$Scholarship_app_1)
barplot(count6, main="Scholarship Applications", xlab="Applied_or_Not", ylab="Number of Applicants", col="hotpink4")
```

###15
```{r}
appbase$age_at_app_new <- ifelse(appbase$age_at_app <=16, NA, appbase$age_at_app)
```

```{r}
appbase$age_at_app_new <- as.numeric(appbase$age_at_app_new)
ggplot(data=appbase, aes(appbase$age_at_app_new)) + 
  geom_histogram(breaks=seq(19, 65, by = 1), 
                 col="orangered", 
                 aes(fill=..count..)) +
  scale_fill_gradient("Count", low = "yellow", high = "orangered")+
  labs(title="Applicant's Age", x="Age", y="Number of Applicants")
```

###16 - Need to update to world map Francis and Shreya and Working on
```{r}
count3 <- table(appbase$citizenship1)
barplot(count3, main="Citizenship_of_Applicants", xlab="First_Citizenship", ylab = "First_Citizenship", col="royalblue1")
```
